const _0x55202f=_0x5817;function _0xa86b(){const _0x537073=['70UeoKMZ','mime_type','https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=','change','bot-responding','</p>','light_mode','user-message','.prompt-wrapper','958960zqrDvJ','scrollHeight','textContent','img-attached','.file-upload-wrapper','innerHTML','result','name','target','content','2276364ldZpEG','startsWith','add','hide-controls','dispatchEvent','split','<p\x20class=\x22file-attachment\x22><span\x20class=\x22material-symbols-rounded\x22>description</span>','forEach','prompt-input','#d62939','preventDefault','file-attached','getItem','543VPkqPK','body','contains','AbortError','loading','.prompt-input','div','.message-text','\x22\x20class=\x22img-attachment\x22\x20/>','36XdGmGv','toggle','554174fhOnNQ','setItem','click','.suggestions-item','chats-active','.bot-message.loading','message','files','classList','scrollTo','replace','length','isImage','2FrCooN','.container','application/json','error','color','.text','value','active','remove','.prompt-form','abort','dark_mode','querySelector','parts','2283688vcNlWK','add-file-btn','1881232ifXQIA','candidates','submit','#stop-response-btn','model','stop-response-btn','data','#theme-toggle-btn','AIzaSyAeLz71UZOEbr-uU6Wm7uowVj0Z3v8HU60','signal','themeColor','file','push','onload','addEventListener','trim',';base64,','appendChild','stringify','#add-file-btn','2132qzSgEd','\x0a\x20\x20','type','\x0a\x20\x20\x20\x20<p\x20class=\x22message-text\x22></p>\x0a\x20\x20\x20\x20','.chats-container','querySelectorAll','createElement','936019ZDvjmx'];_0xa86b=function(){return _0x537073;};return _0xa86b();}(function(_0x580613,_0x4396e1){const _0xa9abb2=_0x5817,_0x312bbc=_0x580613();while(!![]){try{const _0xe3241c=-parseInt(_0xa9abb2(0x188))/0x1*(parseInt(_0xa9abb2(0x195))/0x2)+-parseInt(_0xa9abb2(0x17d))/0x3*(parseInt(_0xa9abb2(0x155))/0x4)+parseInt(_0xa9abb2(0x166))/0x5+parseInt(_0xa9abb2(0x170))/0x6+parseInt(_0xa9abb2(0x15c))/0x7+parseInt(_0xa9abb2(0x1a5))/0x8*(-parseInt(_0xa9abb2(0x186))/0x9)+parseInt(_0xa9abb2(0x15d))/0xa*(parseInt(_0xa9abb2(0x1a3))/0xb);if(_0xe3241c===_0x4396e1)break;else _0x312bbc['push'](_0x312bbc['shift']());}catch(_0x3d3e6b){_0x312bbc['push'](_0x312bbc['shift']());}}}(_0xa86b,0x8a670));function _0x5817(_0x3a709b,_0x2864a9){const _0xa86bb1=_0xa86b();return _0x5817=function(_0x58170d,_0x193688){_0x58170d=_0x58170d-0x153;let _0xba6262=_0xa86bb1[_0x58170d];return _0xba6262;},_0x5817(_0x3a709b,_0x2864a9);}const container=document[_0x55202f(0x1a1)](_0x55202f(0x196)),chatsContainer=document['querySelector'](_0x55202f(0x159)),promptForm=document['querySelector'](_0x55202f(0x19e)),promptInput=promptForm['querySelector'](_0x55202f(0x182)),fileInput=promptForm[_0x55202f(0x1a1)]('#file-input'),fileUploadWrapper=promptForm[_0x55202f(0x1a1)](_0x55202f(0x16a)),themeToggleBtn=document['querySelector'](_0x55202f(0x1ac)),API_KEY=_0x55202f(0x1ad),API_URL=_0x55202f(0x15f)+API_KEY;let controller,typingInterval;const chatHistory=[],userData={'message':'','file':{}},isLightTheme=localStorage[_0x55202f(0x17c)](_0x55202f(0x1af))===_0x55202f(0x163);document[_0x55202f(0x17e)][_0x55202f(0x190)][_0x55202f(0x187)]('light-theme',isLightTheme),themeToggleBtn[_0x55202f(0x168)]=isLightTheme?_0x55202f(0x1a0):_0x55202f(0x163);const createMessageElement=(_0x3c3ba3,..._0x3a899d)=>{const _0x50afd0=_0x55202f,_0x457223=document[_0x50afd0(0x15b)](_0x50afd0(0x183));return _0x457223[_0x50afd0(0x190)][_0x50afd0(0x172)](_0x50afd0(0x18e),..._0x3a899d),_0x457223[_0x50afd0(0x16b)]=_0x3c3ba3,_0x457223;},scrollToBottom=()=>container[_0x55202f(0x191)]({'top':container[_0x55202f(0x167)],'behavior':'smooth'}),typingEffect=(_0x3e7e16,_0x520bd7,_0x593a3d)=>{const _0x3aed4f=_0x55202f;_0x520bd7[_0x3aed4f(0x168)]='';const _0x1a1bb9=_0x3e7e16[_0x3aed4f(0x175)]('\x20');let _0x11766e=0x0;typingInterval=setInterval(()=>{const _0x57abf8=_0x3aed4f;_0x11766e<_0x1a1bb9[_0x57abf8(0x193)]?(_0x520bd7[_0x57abf8(0x168)]+=(_0x11766e===0x0?'':'\x20')+_0x1a1bb9[_0x11766e++],scrollToBottom()):(clearInterval(typingInterval),_0x593a3d[_0x57abf8(0x190)][_0x57abf8(0x19d)]('loading'),document[_0x57abf8(0x17e)][_0x57abf8(0x190)][_0x57abf8(0x19d)]('bot-responding'));},0x28);},generateResponse=async _0x29fc43=>{const _0x2a0047=_0x55202f,_0x804a3d=_0x29fc43[_0x2a0047(0x1a1)](_0x2a0047(0x184));controller=new AbortController(),chatHistory[_0x2a0047(0x1b1)]({'role':'user','parts':[{'text':userData[_0x2a0047(0x18e)]},...userData['file'][_0x2a0047(0x1ab)]?[{'inline_data':(({fileName:_0x420854,isImage:_0x737859,..._0x6ea035})=>_0x6ea035)(userData[_0x2a0047(0x1b0)])}]:[]]});try{const _0x279328=await fetch(API_URL,{'method':'POST','headers':{'Content-Type':_0x2a0047(0x197)},'body':JSON[_0x2a0047(0x153)]({'contents':chatHistory}),'signal':controller[_0x2a0047(0x1ae)]}),_0x49fccf=await _0x279328['json']();if(!_0x279328['ok'])throw new Error(_0x49fccf[_0x2a0047(0x198)][_0x2a0047(0x18e)]);const _0x2a2f85=_0x49fccf[_0x2a0047(0x1a6)][0x0][_0x2a0047(0x16f)][_0x2a0047(0x1a2)][0x0]['text'][_0x2a0047(0x192)](/\*\*([^*]+)\*\*/g,'$1')['trim']();typingEffect(_0x2a2f85,_0x804a3d,_0x29fc43),chatHistory[_0x2a0047(0x1b1)]({'role':_0x2a0047(0x1a9),'parts':[{'text':_0x2a2f85}]});}catch(_0x3996c1){_0x804a3d[_0x2a0047(0x168)]=_0x3996c1[_0x2a0047(0x16d)]===_0x2a0047(0x180)?'Response\x20generation\x20stopped.':_0x3996c1[_0x2a0047(0x18e)],_0x804a3d['style'][_0x2a0047(0x199)]=_0x2a0047(0x179),_0x29fc43[_0x2a0047(0x190)][_0x2a0047(0x19d)](_0x2a0047(0x181)),document['body'][_0x2a0047(0x190)][_0x2a0047(0x19d)](_0x2a0047(0x161)),scrollToBottom();}finally{userData[_0x2a0047(0x1b0)]={};}},handleFormSubmit=_0x3e8e71=>{const _0x5bd65a=_0x55202f;_0x3e8e71[_0x5bd65a(0x17a)]();const _0x147150=promptInput['value'][_0x5bd65a(0x1b4)]();if(!_0x147150||document[_0x5bd65a(0x17e)][_0x5bd65a(0x190)][_0x5bd65a(0x17f)](_0x5bd65a(0x161)))return;userData['message']=_0x147150,promptInput[_0x5bd65a(0x19b)]='',document['body'][_0x5bd65a(0x190)][_0x5bd65a(0x172)](_0x5bd65a(0x18c),_0x5bd65a(0x161)),fileUploadWrapper[_0x5bd65a(0x190)][_0x5bd65a(0x19d)](_0x5bd65a(0x17b),_0x5bd65a(0x169),_0x5bd65a(0x19c));const _0x4ee4ea=_0x5bd65a(0x158)+(userData[_0x5bd65a(0x1b0)][_0x5bd65a(0x1ab)]?userData[_0x5bd65a(0x1b0)][_0x5bd65a(0x194)]?'<img\x20src=\x22data:'+userData[_0x5bd65a(0x1b0)][_0x5bd65a(0x15e)]+_0x5bd65a(0x1b5)+userData['file'][_0x5bd65a(0x1ab)]+_0x5bd65a(0x185):_0x5bd65a(0x176)+userData['file']['fileName']+_0x5bd65a(0x162):'')+_0x5bd65a(0x156),_0x393c29=createMessageElement(_0x4ee4ea,_0x5bd65a(0x164));_0x393c29[_0x5bd65a(0x1a1)]('.message-text')[_0x5bd65a(0x168)]=userData[_0x5bd65a(0x18e)],chatsContainer[_0x5bd65a(0x1b6)](_0x393c29),scrollToBottom(),setTimeout(()=>{const _0x4be565=_0x5bd65a,_0x52e4c8='<img\x20class=\x22avatar\x22\x20src=\x22av.svg\x22\x20/>\x20<p\x20class=\x22message-text\x22>Đợi\x20tôi\x20một\x20chút...</p>',_0x458912=createMessageElement(_0x52e4c8,'bot-message','loading');chatsContainer[_0x4be565(0x1b6)](_0x458912),scrollToBottom(),generateResponse(_0x458912);},0x258);};fileInput['addEventListener'](_0x55202f(0x160),()=>{const _0x43b186=_0x55202f,_0x1393e4=fileInput[_0x43b186(0x18f)][0x0];if(!_0x1393e4)return;const _0x3b6e69=_0x1393e4[_0x43b186(0x157)][_0x43b186(0x171)]('image/'),_0x1ec74e=new FileReader();_0x1ec74e['readAsDataURL'](_0x1393e4),_0x1ec74e[_0x43b186(0x1b2)]=_0x55cb18=>{const _0x230cf6=_0x43b186;fileInput[_0x230cf6(0x19b)]='';const _0x397bc7=_0x55cb18[_0x230cf6(0x16e)][_0x230cf6(0x16c)]['split'](',')[0x1];fileUploadWrapper[_0x230cf6(0x1a1)]('.file-preview')['src']=_0x55cb18[_0x230cf6(0x16e)]['result'],fileUploadWrapper[_0x230cf6(0x190)]['add'](_0x230cf6(0x19c),_0x3b6e69?_0x230cf6(0x169):_0x230cf6(0x17b)),userData[_0x230cf6(0x1b0)]={'fileName':_0x1393e4[_0x230cf6(0x16d)],'data':_0x397bc7,'mime_type':_0x1393e4['type'],'isImage':_0x3b6e69};};}),document[_0x55202f(0x1a1)]('#cancel-file-btn')[_0x55202f(0x1b3)](_0x55202f(0x18a),()=>{const _0x1ed971=_0x55202f;userData['file']={},fileUploadWrapper[_0x1ed971(0x190)][_0x1ed971(0x19d)](_0x1ed971(0x17b),_0x1ed971(0x169),_0x1ed971(0x19c));}),document[_0x55202f(0x1a1)](_0x55202f(0x1a8))[_0x55202f(0x1b3)](_0x55202f(0x18a),()=>{const _0x5a1558=_0x55202f;controller?.[_0x5a1558(0x19f)](),userData[_0x5a1558(0x1b0)]={},clearInterval(typingInterval),chatsContainer['querySelector'](_0x5a1558(0x18d))[_0x5a1558(0x190)][_0x5a1558(0x19d)](_0x5a1558(0x181)),document[_0x5a1558(0x17e)][_0x5a1558(0x190)][_0x5a1558(0x19d)](_0x5a1558(0x161));}),themeToggleBtn[_0x55202f(0x1b3)](_0x55202f(0x18a),()=>{const _0x44751d=_0x55202f,_0x251bf2=document[_0x44751d(0x17e)][_0x44751d(0x190)][_0x44751d(0x187)]('light-theme');localStorage[_0x44751d(0x189)](_0x44751d(0x1af),_0x251bf2?_0x44751d(0x163):_0x44751d(0x1a0)),themeToggleBtn[_0x44751d(0x168)]=_0x251bf2?_0x44751d(0x1a0):_0x44751d(0x163);}),document[_0x55202f(0x1a1)]('#delete-chats-btn')[_0x55202f(0x1b3)](_0x55202f(0x18a),()=>{const _0x2df377=_0x55202f;chatHistory[_0x2df377(0x193)]=0x0,chatsContainer['innerHTML']='',document['body'][_0x2df377(0x190)]['remove'](_0x2df377(0x18c),'bot-responding');}),document[_0x55202f(0x15a)](_0x55202f(0x18b))[_0x55202f(0x177)](_0x28a0fc=>{const _0x40159e=_0x55202f;_0x28a0fc[_0x40159e(0x1b3)](_0x40159e(0x18a),()=>{const _0x485893=_0x40159e;promptInput[_0x485893(0x19b)]=_0x28a0fc[_0x485893(0x1a1)](_0x485893(0x19a))[_0x485893(0x168)],promptForm[_0x485893(0x174)](new Event(_0x485893(0x1a7)));});}),document['addEventListener'](_0x55202f(0x18a),({target:_0x42b588})=>{const _0x5203e0=_0x55202f,_0x41948b=document[_0x5203e0(0x1a1)](_0x5203e0(0x165)),_0x2f79be=_0x42b588['classList']['contains'](_0x5203e0(0x178))||_0x41948b['classList'][_0x5203e0(0x17f)]('hide-controls')&&(_0x42b588['id']===_0x5203e0(0x1a4)||_0x42b588['id']===_0x5203e0(0x1aa));_0x41948b[_0x5203e0(0x190)][_0x5203e0(0x187)](_0x5203e0(0x173),_0x2f79be);}),promptForm[_0x55202f(0x1b3)](_0x55202f(0x1a7),handleFormSubmit),promptForm[_0x55202f(0x1a1)](_0x55202f(0x154))[_0x55202f(0x1b3)](_0x55202f(0x18a),()=>fileInput[_0x55202f(0x18a)]());